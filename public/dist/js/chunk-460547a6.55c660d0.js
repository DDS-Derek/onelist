(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-460547a6"],{"53fd":function(e,t,l){},"7a43":function(e,t,l){"use strict";l("53fd")},b426:function(e,t,l){"use strict";l.r(t);var a=l("7a23");const c=e=>(Object(a["L"])("data-v-c8109328"),e=e(),Object(a["J"])(),e),i={key:0,class:"load"},b={key:1,class:"content"},s={class:"content-header"},o=c(()=>Object(a["l"])("div",{class:"content-header-title"}," 媒体库 ",-1)),d={class:"content-header-tool"},n=c(()=>Object(a["l"])("i",{class:"bx bx-analyse"},null,-1)),r=c(()=>Object(a["l"])("i",{class:"bx bx-plus-circle"},null,-1)),O={class:"gallery-list"},j=c(()=>Object(a["l"])("i",{class:"bx bx-detail"},null,-1)),u=["src"],h={key:1,loading:"lazy",class:"gallery-img",src:"/images/not_gellery.png"},p={class:"gallery-tool"},g={class:"gallery-data"},y={class:"gallery-type"},_={class:"gallery-alist"},v={class:"gallery-show"},f=c(()=>Object(a["l"])("i",{class:"bx bx-plus-circle"},null,-1)),m=c(()=>Object(a["l"])("i",{class:"bx bx-folder-plus"},null,-1)),w=c(()=>Object(a["l"])("i",{class:"bx bx-x"},null,-1)),x=c(()=>Object(a["l"])("i",{class:"bx bx-image-add"},null,-1)),k=c(()=>Object(a["l"])("i",{class:"bx bx-save"},null,-1)),z=c(()=>Object(a["l"])("i",{class:"bx bx-x"},null,-1)),M=c(()=>Object(a["l"])("i",{class:"bx bx-trash"},null,-1)),U=c(()=>Object(a["l"])("i",{class:"bx bx-image-add"},null,-1)),C=c(()=>Object(a["l"])("i",{class:"bx bx-save"},null,-1)),A=c(()=>Object(a["l"])("i",{class:"bx bx-x"},null,-1)),I=c(()=>Object(a["l"])("i",{class:"bx bx-search"},null,-1)),R={class:"search-list"},F={class:"search-img"},T=["src"],N={class:"search-content"},$={class:"search-title"},q={class:"search-id"},Y={class:"search-overview"},D=c(()=>Object(a["l"])("input",{type:"file",id:"file"},null,-1));function S(e,t,l,c,S,P){const V=Object(a["R"])("n-button"),E=Object(a["R"])("n-space"),G=Object(a["R"])("n-card"),J=Object(a["R"])("n-gi"),L=Object(a["R"])("n-grid"),B=Object(a["R"])("n-input"),K=Object(a["R"])("n-form-item"),H=Object(a["R"])("n-select"),Q=Object(a["R"])("n-switch"),W=Object(a["R"])("n-form"),X=Object(a["R"])("n-modal"),Z=Object(a["R"])("n-spin");return c.loading?(Object(a["I"])(),Object(a["k"])("div",i)):(Object(a["I"])(),Object(a["k"])("div",b,[Object(a["l"])("div",s,[o,Object(a["l"])("div",d,[Object(a["n"])(E,{justify:"end",size:"medium"},{default:Object(a["bb"])(()=>[Object(a["n"])(V,{onClick:t[0]||(t[0]=e=>c.reF()),type:"info"},{icon:Object(a["bb"])(()=>[n]),default:Object(a["bb"])(()=>[Object(a["m"])(" 刷新 ")]),_:1}),Object(a["n"])(V,{onClick:t[1]||(t[1]=e=>P.CreateShow()),type:"info"},{icon:Object(a["bb"])(()=>[r]),default:Object(a["bb"])(()=>[Object(a["m"])(" 新增 ")]),_:1})]),_:1})])]),Object(a["l"])("div",O,[Object(a["n"])(L,{"x-gap":"12","y-gap":"12",cols:"1 s:2 m:2 l:4 xl:4 2xl:8",responsive:"screen"},{default:Object(a["bb"])(()=>[(Object(a["I"])(!0),Object(a["k"])(a["b"],null,Object(a["P"])(c.data,(t,l)=>(Object(a["I"])(),Object(a["i"])(J,{key:l},{default:Object(a["bb"])(()=>[Object(a["n"])(G,{title:t.title},{"header-extra":Object(a["bb"])(()=>[Object(a["n"])(E,{justify:"end",size:"medium"},{default:Object(a["bb"])(()=>[Object(a["n"])(V,{onClick:e=>P.EditGallery(t),strong:"",secondary:"",circle:""},{default:Object(a["bb"])(()=>[j]),_:2},1032,["onClick"])]),_:2},1024)]),footer:Object(a["bb"])(()=>[Object(a["l"])("div",p,[Object(a["l"])("div",g,[Object(a["n"])(E,{justify:"start",size:"medium",vertical:""},{default:Object(a["bb"])(()=>[Object(a["l"])("div",y," 类别："+Object(a["T"])(t.gallery_type),1),Object(a["l"])("div",_," alist："+Object(a["T"])(t.is_alist?"是":"否"),1)]),_:2},1024)]),Object(a["l"])("div",v,[Object(a["n"])(V,{class:"add-video",onClick:e=>P.showAdd(t),type:"info"},{icon:Object(a["bb"])(()=>[f]),default:Object(a["bb"])(()=>[Object(a["m"])(" 添加资源 ")]),_:2},1032,["onClick"]),Object(a["n"])(V,{onClick:e=>P.addPath(t),type:"info"},{icon:Object(a["bb"])(()=>[m]),default:Object(a["bb"])(()=>[Object(a["m"])(" 挂载目录 ")]),_:2},1032,["onClick"])])])]),default:Object(a["bb"])(()=>[t.image.length>0?(Object(a["I"])(),Object(a["k"])("img",{key:0,loading:"lazy",class:"gallery-img",src:-1!=t.image.search(/gallery/)?e.COMMON.apiUrl+t.image:e.COMMON.imgUrl+"/t/p/w355_and_h200_multi_faces"+t.image},null,8,u)):(Object(a["I"])(),Object(a["k"])("img",h))]),_:2},1032,["title"])]),_:2},1024))),128))]),_:1})]),Object(a["n"])(X,{class:"create",show:c.showModal,"onUpdate:show":t[12]||(t[12]=e=>c.showModal=e),"transform-origin":"center"},{default:Object(a["bb"])(()=>[Object(a["n"])(G,{style:{width:"600px"},title:"创建",bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{"header-extra":Object(a["bb"])(()=>[Object(a["n"])(V,{onClick:t[2]||(t[2]=e=>c.showModal=!c.showModal),strong:"",secondary:"",circle:""},{default:Object(a["bb"])(()=>[w]),_:1})]),footer:Object(a["bb"])(()=>[Object(a["n"])(E,{justify:"end",size:"medium"},{default:Object(a["bb"])(()=>[Object(a["n"])(V,{onClick:t[10]||(t[10]=e=>P.showUpload()),type:"info"},{icon:Object(a["bb"])(()=>[x]),default:Object(a["bb"])(()=>[Object(a["m"])(" 上传封面 ")]),_:1}),Object(a["n"])(V,{onClick:t[11]||(t[11]=e=>P.Create()),type:"info"},{icon:Object(a["bb"])(()=>[k]),default:Object(a["bb"])(()=>[Object(a["m"])(" 创建影库 ")]),_:1})]),_:1})]),default:Object(a["bb"])(()=>[Object(a["n"])(W,{model:c.gallery},{default:Object(a["bb"])(()=>[Object(a["n"])(K,{label:"媒体库标题"},{default:Object(a["bb"])(()=>[Object(a["n"])(B,{size:"large",value:c.gallery.title,"onUpdate:value":t[3]||(t[3]=e=>c.gallery.title=e),placeholder:"",clearable:""},null,8,["value"])]),_:1}),Object(a["n"])(K,{label:"封面图片"},{default:Object(a["bb"])(()=>[Object(a["n"])(B,{size:"large",value:c.gallery.image,"onUpdate:value":t[4]||(t[4]=e=>c.gallery.image=e),placeholder:"",clearable:""},null,8,["value"])]),_:1}),Object(a["n"])(K,{label:"类型",path:""},{default:Object(a["bb"])(()=>[Object(a["n"])(H,{size:"large",value:c.gallery.gallery_type,"onUpdate:value":t[5]||(t[5]=e=>c.gallery.gallery_type=e),placeholder:"Select",options:c.typeOptions},null,8,["value","options"])]),_:1}),Object(a["n"])(K,{label:"是否为alist,如果是则需要输入相关信息，用于刮削文件?"},{default:Object(a["bb"])(()=>[Object(a["n"])(Q,{size:"large",value:c.gallery.is_alist,"onUpdate:value":t[6]||(t[6]=e=>c.gallery.is_alist=e),placeholder:"",clearable:""},null,8,["value"])]),_:1}),Object(a["cb"])(Object(a["n"])(K,{label:"域名"},{default:Object(a["bb"])(()=>[Object(a["n"])(B,{size:"large",value:c.gallery.alist_host,"onUpdate:value":t[7]||(t[7]=e=>c.gallery.alist_host=e),placeholder:"",clearable:""},null,8,["value"])]),_:1},512),[[a["Y"],c.gallery.is_alist]]),Object(a["cb"])(Object(a["n"])(K,{label:"账号"},{default:Object(a["bb"])(()=>[Object(a["n"])(B,{size:"large",value:c.gallery.alist_user,"onUpdate:value":t[8]||(t[8]=e=>c.gallery.alist_user=e),placeholder:"",clearable:""},null,8,["value"])]),_:1},512),[[a["Y"],c.gallery.is_alist]]),Object(a["cb"])(Object(a["n"])(K,{label:"密码"},{default:Object(a["bb"])(()=>[Object(a["n"])(B,{type:"password","show-password-on":"mousedown",size:"large",value:c.gallery.alist_pwd,"onUpdate:value":t[9]||(t[9]=e=>c.gallery.alist_pwd=e),placeholder:"",clearable:""},null,8,["value"])]),_:1},512),[[a["Y"],c.gallery.is_alist]])]),_:1},8,["model"])]),_:1})]),_:1},8,["show"]),Object(a["n"])(X,{class:"update",show:c.updateModal,"onUpdate:show":t[24]||(t[24]=e=>c.updateModal=e),"transform-origin":"center"},{default:Object(a["bb"])(()=>[Object(a["n"])(G,{style:{width:"600px"},title:"更新",bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{"header-extra":Object(a["bb"])(()=>[Object(a["n"])(V,{onClick:t[13]||(t[13]=e=>c.updateModal=!c.updateModal),strong:"",secondary:"",circle:""},{default:Object(a["bb"])(()=>[z]),_:1})]),footer:Object(a["bb"])(()=>[Object(a["n"])(E,{justify:"end",size:"medium"},{default:Object(a["bb"])(()=>[Object(a["n"])(V,{onClick:t[21]||(t[21]=e=>P.Delete()),type:"warning"},{icon:Object(a["bb"])(()=>[M]),default:Object(a["bb"])(()=>[Object(a["m"])(" 删除影库 ")]),_:1}),Object(a["n"])(V,{onClick:t[22]||(t[22]=e=>P.showUpload()),type:"info"},{icon:Object(a["bb"])(()=>[U]),default:Object(a["bb"])(()=>[Object(a["m"])(" 上传封面 ")]),_:1}),Object(a["n"])(V,{onClick:t[23]||(t[23]=e=>P.Update()),type:"info"},{icon:Object(a["bb"])(()=>[C]),default:Object(a["bb"])(()=>[Object(a["m"])(" 更新影库 ")]),_:1})]),_:1})]),default:Object(a["bb"])(()=>[Object(a["n"])(W,{model:c.gallery},{default:Object(a["bb"])(()=>[Object(a["n"])(K,{label:"媒体库标题"},{default:Object(a["bb"])(()=>[Object(a["n"])(B,{size:"large",value:c.gallery.title,"onUpdate:value":t[14]||(t[14]=e=>c.gallery.title=e),placeholder:"",clearable:""},null,8,["value"])]),_:1}),Object(a["n"])(K,{label:"封面图片"},{default:Object(a["bb"])(()=>[Object(a["n"])(B,{size:"large",value:c.gallery.image,"onUpdate:value":t[15]||(t[15]=e=>c.gallery.image=e),placeholder:"",clearable:""},null,8,["value"])]),_:1}),Object(a["n"])(K,{label:"类型",path:""},{default:Object(a["bb"])(()=>[Object(a["n"])(H,{size:"large",value:c.gallery.gallery_type,"onUpdate:value":t[16]||(t[16]=e=>c.gallery.gallery_type=e),placeholder:"Select",options:c.typeOptions},null,8,["value","options"])]),_:1}),Object(a["n"])(K,{label:"是否为alist,如果是则需要输入以下相关信息，用于刮削文件?"},{default:Object(a["bb"])(()=>[Object(a["n"])(Q,{size:"large",value:c.gallery.is_alist,"onUpdate:value":t[17]||(t[17]=e=>c.gallery.is_alist=e),placeholder:"",clearable:""},null,8,["value"])]),_:1}),Object(a["cb"])(Object(a["n"])(K,{label:"域名"},{default:Object(a["bb"])(()=>[Object(a["n"])(B,{size:"large",value:c.gallery.alist_host,"onUpdate:value":t[18]||(t[18]=e=>c.gallery.alist_host=e),placeholder:"",clearable:""},null,8,["value"])]),_:1},512),[[a["Y"],c.gallery.is_alist]]),Object(a["cb"])(Object(a["n"])(K,{label:"账号"},{default:Object(a["bb"])(()=>[Object(a["n"])(B,{size:"large",value:c.gallery.alist_user,"onUpdate:value":t[19]||(t[19]=e=>c.gallery.alist_user=e),placeholder:"",clearable:""},null,8,["value"])]),_:1},512),[[a["Y"],c.gallery.is_alist]]),Object(a["cb"])(Object(a["n"])(K,{label:"密码"},{default:Object(a["bb"])(()=>[Object(a["n"])(B,{size:"large",type:"password","show-password-on":"mousedown",value:c.gallery.alist_pwd,"onUpdate:value":t[20]||(t[20]=e=>c.gallery.alist_pwd=e),placeholder:"",clearable:""},null,8,["value"])]),_:1},512),[[a["Y"],c.gallery.is_alist]])]),_:1},8,["model"])]),_:1})]),_:1},8,["show"]),Object(a["n"])(X,{class:"add",show:c.addModal,"onUpdate:show":t[31]||(t[31]=e=>c.addModal=e),"transform-origin":"center"},{default:Object(a["bb"])(()=>[Object(a["n"])(G,{style:{width:"600px"},title:"添加",bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{"header-extra":Object(a["bb"])(()=>[Object(a["n"])(V,{onClick:t[25]||(t[25]=e=>c.addModal=!c.addModal),strong:"",secondary:"",circle:""},{default:Object(a["bb"])(()=>[A]),_:1})]),footer:Object(a["bb"])(()=>[Object(a["n"])(E,{justify:"end",size:"medium"},{default:Object(a["bb"])(()=>[Object(a["n"])(V,{onClick:t[30]||(t[30]=e=>P.SearchVideo()),type:"info"},{default:Object(a["bb"])(()=>[Object(a["m"])(" 搜索 ")]),_:1})]),_:1})]),default:Object(a["bb"])(()=>[Object(a["n"])(Z,{show:c.show},{default:Object(a["bb"])(()=>[Object(a["n"])(W,{model:c.addvideo},{default:Object(a["bb"])(()=>[Object(a["cb"])(Object(a["n"])(K,{label:"文件链接"},{default:Object(a["bb"])(()=>[Object(a["n"])(B,{onFocus:P.FilehandleFocus,size:"large",value:c.addvideo.file,"onUpdate:value":t[26]||(t[26]=e=>c.addvideo.file=e),placeholder:"",clearable:""},null,8,["onFocus","value"])]),_:1},512),[[a["Y"],"movie"==c.addType]]),Object(a["cb"])(Object(a["n"])(K,{label:"电视文件夹"},{default:Object(a["bb"])(()=>[Object(a["n"])(B,{onFocus:P.PathhandleFocus,size:"large",value:c.addvideo.path,"onUpdate:value":t[27]||(t[27]=e=>c.addvideo.path=e),placeholder:"",clearable:""},null,8,["onFocus","value"])]),_:1},512),[[a["Y"],"tv"==c.addType]]),Object(a["n"])(K,{label:"输入关键字搜索"},{default:Object(a["bb"])(()=>[Object(a["n"])(B,{onKeyup:t[28]||(t[28]=Object(a["db"])(e=>P.SearchVideo(),["enter"])),value:c.q,"onUpdate:value":t[29]||(t[29]=e=>c.q=e),type:"text",size:"large",placeholder:""},{prefix:Object(a["bb"])(()=>[I]),_:1},8,["value"])]),_:1}),Object(a["l"])("div",R,[(Object(a["I"])(!0),Object(a["k"])(a["b"],null,Object(a["P"])(c.searchData,(e,t)=>(Object(a["I"])(),Object(a["k"])("div",{class:"search-itme",key:t},[Object(a["l"])("div",F,[Object(a["l"])("img",{loading:"lazy",src:"https://image.tmdb.org/t/p/w220_and_h330_face/"+e.poster_path},null,8,T)]),Object(a["l"])("div",N,[Object(a["l"])("div",$,Object(a["T"])(e.name),1),Object(a["l"])("div",q," ID:"+Object(a["T"])(e.id),1),Object(a["l"])("div",Y," 简介:"+Object(a["T"])(e.overview),1),Object(a["n"])(E,{justify:"end",size:"medium"},{default:Object(a["bb"])(()=>[Object(a["n"])(V,{onClick:t=>P.AddVideo(e.id),type:"info"},{default:Object(a["bb"])(()=>[Object(a["m"])(" 选中刮削 ")]),_:2},1032,["onClick"])]),_:2},1024)])]))),128))])]),_:1},8,["model"])]),_:1},8,["show"])]),_:1})]),_:1},8,["show"]),D]))}l("14d9");var P=l("7317"),V=l("0d1c"),E=l.n(V),G={name:"GalleryIndex",setup(){const e=Object(P["a"])(),t=Object(a["O"])(!0),l=Object(a["O"])(!1),c=Object(a["O"])(!1),i=Object(a["O"])(!1),b=Object(a["O"])(null),s=Object(a["O"])(null),o=Object(a["O"])(null),d=Object(a["O"])(!1),n=Object(a["O"])(null),r=Object(a["O"])(null),{proxy:O}=Object(a["p"])(),j=Object(a["O"])(1),u=Object(a["O"])(24),h=Object(a["O"])("创建"),p=Object(a["O"])(null),g=Object(a["O"])({id:null,title:"",gallery_type:"",is_tv:!0,gallery_uid:"",image:"",is_alist:!1,alist_host:"",alist_user:"",alist_pwd:""}),y=Object(a["O"])({the_movie_id:null,the_tv_id:null,path:null,file:null,gallery_uid:null});function _(){O.axios.post(O.COMMON.apiUrl+"/v1/api/gallery/list?page="+j.value+"&size="+u.value,{},{headers:{"content-type":"application/json",Authorization:O.$cookies.get("Authorization")}}).then(e=>{200==e.data.code?(s.value=e.data.data,t.value=!1):E.a.show({pos:"top-center",text:e.data.msg,showAction:!1})}).catch(e=>{E.a.show({pos:"top-center",text:e,showAction:!1})})}const v=async()=>{_()};return Object(a["F"])(()=>{_()}),{data:s,error:b,show:d,loading:t,showModal:l,page:j,gallery:g,modal_title:h,size:u,updateModal:i,gallery_uid:r,q:o,reF:v,addType:n,addvideo:y,addModal:c,searchData:p,message:e,typeOptions:["movie","tv"].map(e=>({label:e,value:e}))}},methods:{PathhandleFocus(){this.message.info("挂载本地就为包含该部剧全部文件的绝路路径文件夹;挂载alist的就为去掉域名后的文件夹",{duration:8e3})},FilehandleFocus(){this.message.info("挂载本地就为文件绝对路径;挂载alist的就为去掉域名后的文件路径",{duration:8e3})},showUpload(){let e=document.getElementById("file");e.click(),e.addEventListener("change",e=>{let t=e.target.files[0];this.UploadImage(t)})},UploadImage(e){let t=this.COMMON.apiUrl+"/file/gallery/upload",l=new FormData;l.set("file",e),this.axios.post(t,l,{headers:{"content-type":"application/json",Authorization:this.$cookies.get("Authorization")}}).then(e=>{200==e.data.code?(this.gallery.image=e.data.data,E.a.show({pos:"top-center",text:e.data.msg,showAction:!1})):E.a.show({pos:"top-center",text:e.data.msg,showAction:!1})}).catch(e=>{E.a.show({pos:"top-center",text:e,showAction:!1})})},CreateShow(){this.gallery={title:"",gallery_type:"",is_tv:!1,gallery_uid:"",image:"",is_alist:!0,alist_host:"",alist_user:"",alist_pwd:""},this.showModal=!this.showModal},EditGallery(e){this.gallery=e,this.updateModal=!this.updateModal},Request(e,t){this.axios.post(e,t,{headers:{"content-type":"application/json",Authorization:this.$cookies.get("Authorization")}}).then(e=>{200==e.data.code?(this.$emit("refApp"),E.a.show({pos:"top-center",text:e.data.msg,showAction:!1}),this.reF()):E.a.show({pos:"top-center",text:e.data.msg,showAction:!1})}).catch(e=>{E.a.show({pos:"top-center",text:e,showAction:!1})})},Create(){"tv"==this.gallery.gallery_type&&(this.gallery.is_tv=!0),this.Request(this.COMMON.apiUrl+"/v1/api/gallery/create",this.gallery)},Update(){this.Request(this.COMMON.apiUrl+"/v1/api/gallery/update?id="+this.gallery.id,this.gallery)},Delete(){this.Request(this.COMMON.apiUrl+"/v1/api/gallery/delete?id="+this.gallery.id,{})},addPath(e){this.$router.push({path:"/gallerys/works",query:{gallery_uid:e.gallery_uid}})},showAdd(e){this.addType=e.gallery_type,this.gallery_uid=e.gallery_uid,this.addvideo.gallery_uid=this.gallery_uid,this.addModal=!this.addModal},AddVideo(e){"movie"==this.addType?this.addvideo.the_movie_id=e:this.addvideo.the_tv_id=e,this.show=!0;let t=this.COMMON.apiUrl+"/v1/api/themovie/add";"tv"==this.addType?t=this.COMMON.apiUrl+"/v1/api/thetv/add":E.a.show({pos:"top-center",text:"刮削比较耗时,可离开此页面或者耐心等待....",showAction:!1}),this.addvideo.the_movie_id=parseInt(this.addvideo.the_movie_id),this.addvideo.the_tv_id=parseInt(this.addvideo.the_tv_id),this.axios.post(t,this.addvideo,{headers:{"content-type":"application/json",Authorization:this.$cookies.get("Authorization")}}).then(e=>{e.data.code,E.a.show({pos:"top-center",text:e.data.msg,showAction:!1}),this.show=!1}).catch(e=>{E.a.show({pos:"top-center",text:e,showAction:!1})})},SearchVideo(){this.show=!0;let e=`${this.COMMON.apiUrl}/v1/api/errfile/ref/file/search?name=${this.q}&type=${this.addType}`;this.axios.post(e,{},{headers:{"content-type":"application/json",Authorization:this.$cookies.get("Authorization")}}).then(e=>{200==e.data.code?(E.a.show({pos:"top-center",text:e.data.msg,showAction:!1}),0==e.data.data.results.length&&E.a.show({pos:"top-center",text:"未查询到任何资源!",showAction:!1}),this.searchData=e.data.data.results):E.a.show({pos:"top-center",text:e.data.msg,showAction:!1}),this.show=!1}).catch(e=>{E.a.show({pos:"top-center",text:e,showAction:!1})})}}},J=(l("7a43"),l("6b0d")),L=l.n(J);const B=L()(G,[["render",S],["__scopeId","data-v-c8109328"]]);t["default"]=B}}]);
//# sourceMappingURL=chunk-460547a6.55c660d0.js.map