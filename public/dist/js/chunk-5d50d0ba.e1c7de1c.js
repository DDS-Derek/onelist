(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5d50d0ba"],{"2f72":function(e,t,a){},"3c21":function(e,t,a){"use strict";a.r(t);var l=a("7a23");const c=e=>(Object(l["L"])("data-v-418cf712"),e=e(),Object(l["J"])(),e),o={key:0,class:"load"},b={key:1,class:"content"},i={class:"content-header"},s=c(()=>Object(l["l"])("div",{class:"content-header-title"}," 挂载目录 ",-1)),n={class:"content-header-tool"},r=c(()=>Object(l["l"])("i",{class:"bx bx-analyse"},null,-1)),d=c(()=>Object(l["l"])("i",{class:"bx bx-plus-circle"},null,-1)),O={class:"work-list"},j=c(()=>Object(l["l"])("i",{class:"bx bx-detail"},null,-1)),u={class:"progres-content"},h={class:"work-tool"},p={class:"work-data"},w={class:"work-type"},f={class:"work-alist"},k={class:"work-watching"},g=c(()=>Object(l["l"])("i",{class:"bx bx-error"},null,-1)),_=c(()=>Object(l["l"])("i",{class:"bx bx-plus-circle"},null,-1)),v=c(()=>Object(l["l"])("i",{class:"bx bx-x"},null,-1)),m=c(()=>Object(l["l"])("i",{class:"bx bx-save"},null,-1)),x=c(()=>Object(l["l"])("i",{class:"bx bx-x"},null,-1)),y=c(()=>Object(l["l"])("i",{class:"bx bx-trash"},null,-1)),M=c(()=>Object(l["l"])("i",{class:"bx bx-save"},null,-1)),z=c(()=>Object(l["l"])("i",{class:"bx bx-x"},null,-1)),C=c(()=>Object(l["l"])("h3",null,"确定重新刮削此挂载目录吗？",-1));function R(e,t,a,c,R,A){const U=Object(l["R"])("n-button"),N=Object(l["R"])("n-space"),F=Object(l["R"])("n-progress"),$=Object(l["R"])("n-card"),q=Object(l["R"])("n-gi"),I=Object(l["R"])("n-grid"),E=Object(l["R"])("n-input"),J=Object(l["R"])("n-form-item"),T=Object(l["R"])("n-switch"),W=Object(l["R"])("n-form"),D=Object(l["R"])("n-spin"),S=Object(l["R"])("n-modal");return c.loading?(Object(l["I"])(),Object(l["k"])("div",o)):(Object(l["I"])(),Object(l["k"])("div",b,[Object(l["l"])("div",i,[s,Object(l["l"])("div",n,[Object(l["n"])(N,{justify:"end",size:"medium"},{default:Object(l["bb"])(()=>[Object(l["n"])(U,{onClick:t[0]||(t[0]=e=>c.reF()),type:"info"},{icon:Object(l["bb"])(()=>[r]),default:Object(l["bb"])(()=>[Object(l["m"])(" 刷新 ")]),_:1}),Object(l["n"])(U,{onClick:t[1]||(t[1]=e=>A.CreateShow()),type:"info"},{icon:Object(l["bb"])(()=>[d]),default:Object(l["bb"])(()=>[Object(l["m"])(" 新增 ")]),_:1})]),_:1})])]),Object(l["l"])("div",O,[Object(l["n"])(I,{"x-gap":"12","y-gap":"12",cols:"1 s:2 m:2 l:4 xl:4 2xl:8",responsive:"screen"},{default:Object(l["bb"])(()=>[(Object(l["I"])(!0),Object(l["k"])(l["b"],null,Object(l["P"])(c.data,(e,t)=>(Object(l["I"])(),Object(l["i"])(q,{key:t},{default:Object(l["bb"])(()=>[Object(l["n"])($,{title:"目录"},{"header-extra":Object(l["bb"])(()=>[Object(l["n"])(U,{onClick:t=>A.Editwork(e),strong:"",secondary:"",circle:""},{default:Object(l["bb"])(()=>[j]),_:2},1032,["onClick"])]),footer:Object(l["bb"])(()=>[Object(l["l"])("div",h,[Object(l["l"])("div",p,[Object(l["n"])(N,{justify:"start",size:"medium",vertical:""},{default:Object(l["bb"])(()=>[Object(l["l"])("div",w," 挂载目录："+Object(l["T"])(e.path),1),Object(l["l"])("div",f," 已完成："+Object(l["T"])(e.is_ok?"是":"否"),1),Object(l["l"])("div",k," 监控中："+Object(l["T"])(e.watching?"是":"否"),1)]),_:2},1024)]),Object(l["n"])(N,{justify:"end",size:"medium"},{default:Object(l["bb"])(()=>[Object(l["n"])(U,{onClick:t=>A.ErrFiles(e),type:"error"},{icon:Object(l["bb"])(()=>[g]),default:Object(l["bb"])(()=>[Object(l["m"])(" 出错文件 ")]),_:2},1032,["onClick"]),Object(l["n"])(U,{onClick:t=>A.showReNew(e),type:"info"},{icon:Object(l["bb"])(()=>[_]),default:Object(l["bb"])(()=>[Object(l["m"])(" 重新刮削 ")]),_:2},1032,["onClick"])]),_:2},1024)])]),default:Object(l["bb"])(()=>[Object(l["l"])("div",u,[Object(l["n"])(F,{type:"circle",percentage:(100*e.speed/e.file_number).toFixed(0)},null,8,["percentage"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),Object(l["n"])(S,{class:"create",show:c.showModal,"onUpdate:show":t[7]||(t[7]=e=>c.showModal=e),"transform-origin":"center"},{default:Object(l["bb"])(()=>[Object(l["n"])($,{style:{width:"600px"},title:"创建",bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{"header-extra":Object(l["bb"])(()=>[Object(l["n"])(U,{onClick:t[2]||(t[2]=e=>c.showModal=!c.showModal),strong:"",secondary:"",circle:""},{default:Object(l["bb"])(()=>[v]),_:1})]),footer:Object(l["bb"])(()=>[Object(l["n"])(N,{justify:"end",size:"medium"},{default:Object(l["bb"])(()=>[Object(l["n"])(U,{onClick:t[6]||(t[6]=e=>A.Create()),type:"info"},{icon:Object(l["bb"])(()=>[m]),default:Object(l["bb"])(()=>[Object(l["m"])(" 创建 ")]),_:1})]),_:1})]),default:Object(l["bb"])(()=>[Object(l["n"])(D,{show:c.show},{default:Object(l["bb"])(()=>[Object(l["n"])(W,{model:c.work},{default:Object(l["bb"])(()=>[Object(l["n"])(J,{label:"目录"},{default:Object(l["bb"])(()=>[Object(l["n"])(E,{size:"large",value:c.work.path,"onUpdate:value":t[3]||(t[3]=e=>c.work.path=e),placeholder:"",clearable:""},null,8,["value"])]),_:1}),Object(l["n"])(J,{label:"是否强制刷新alist缓存后再获取文件?"},{default:Object(l["bb"])(()=>[Object(l["n"])(T,{size:"large",value:c.work.is_ref,"onUpdate:value":t[4]||(t[4]=e=>c.work.is_ref=e),placeholder:"",clearable:""},null,8,["value"])]),_:1}),Object(l["n"])(J,{label:"是否监控目录,每天晚上2点自动扫描?"},{default:Object(l["bb"])(()=>[Object(l["n"])(T,{size:"large",value:c.work.watching,"onUpdate:value":t[5]||(t[5]=e=>c.work.watching=e),placeholder:"",clearable:""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["show"])]),_:1})]),_:1},8,["show"]),Object(l["n"])(S,{class:"update",show:c.updateModal,"onUpdate:show":t[15]||(t[15]=e=>c.updateModal=e),"transform-origin":"center"},{default:Object(l["bb"])(()=>[Object(l["n"])($,{style:{width:"600px"},title:"更新",bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{"header-extra":Object(l["bb"])(()=>[Object(l["n"])(U,{onClick:t[8]||(t[8]=e=>c.updateModal=!c.updateModal),strong:"",secondary:"",circle:""},{default:Object(l["bb"])(()=>[x]),_:1})]),footer:Object(l["bb"])(()=>[Object(l["n"])(N,{justify:"end",size:"medium"},{default:Object(l["bb"])(()=>[Object(l["n"])(U,{onClick:t[13]||(t[13]=e=>A.Delete()),type:"warning"},{icon:Object(l["bb"])(()=>[y]),default:Object(l["bb"])(()=>[Object(l["m"])(" 删除 ")]),_:1}),Object(l["n"])(U,{onClick:t[14]||(t[14]=e=>A.Update()),type:"info"},{icon:Object(l["bb"])(()=>[M]),default:Object(l["bb"])(()=>[Object(l["m"])(" 更新 ")]),_:1})]),_:1})]),default:Object(l["bb"])(()=>[Object(l["n"])(W,{model:c.work},{default:Object(l["bb"])(()=>[Object(l["n"])(J,{label:"目录"},{default:Object(l["bb"])(()=>[Object(l["n"])(E,{size:"large",value:c.work.path,"onUpdate:value":t[9]||(t[9]=e=>c.work.path=e),placeholder:"",clearable:""},null,8,["value"])]),_:1}),Object(l["n"])(J,{label:"封面图片"},{default:Object(l["bb"])(()=>[Object(l["n"])(E,{size:"large",value:c.work.image,"onUpdate:value":t[10]||(t[10]=e=>c.work.image=e),placeholder:"",clearable:""},null,8,["value"])]),_:1}),Object(l["n"])(J,{label:"是否强制刷新alist缓存后再获取文件?"},{default:Object(l["bb"])(()=>[Object(l["n"])(T,{size:"large",value:c.work.is_ref,"onUpdate:value":t[11]||(t[11]=e=>c.work.is_ref=e),placeholder:"",clearable:""},null,8,["value"])]),_:1}),Object(l["n"])(J,{label:"是否监控目录，每天晚上2点自动扫描?"},{default:Object(l["bb"])(()=>[Object(l["n"])(T,{size:"large",value:c.work.watching,"onUpdate:value":t[12]||(t[12]=e=>c.work.watching=e),placeholder:"",clearable:""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["show"]),Object(l["n"])(S,{class:"renew","transform-origin":"center",show:c.renewModal,"onUpdate:show":t[18]||(t[18]=e=>c.renewModal=e)},{default:Object(l["bb"])(()=>[Object(l["n"])($,{style:{width:"600px"},title:"确认",bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{"header-extra":Object(l["bb"])(()=>[Object(l["n"])(U,{onClick:t[16]||(t[16]=e=>c.renewModal=!c.renewModal),strong:"",secondary:"",circle:""},{default:Object(l["bb"])(()=>[z]),_:1})]),footer:Object(l["bb"])(()=>[Object(l["n"])(N,{justify:"end",size:"medium"},{default:Object(l["bb"])(()=>[Object(l["n"])(U,{onClick:t[17]||(t[17]=e=>A.ReNewWork()),type:"info"},{default:Object(l["bb"])(()=>[Object(l["m"])(" 确定 ")]),_:1})]),_:1})]),default:Object(l["bb"])(()=>[C]),_:1})]),_:1},8,["show"])]))}a("14d9");var A=a("0d1c"),U=a.n(A),N={name:"WorkIndex",setup(){const e=Object(l["O"])(!0),t=Object(l["O"])(!1),a=Object(l["O"])(!1),c=Object(l["O"])(!1),o=Object(l["O"])(!1),b=Object(l["O"])(null),i=Object(l["O"])(null),s=Object(l["O"])(null),{proxy:n}=Object(l["p"])(),r=Object(l["O"])(1),d=Object(l["O"])(24);b.value=n.$route.query.gallery_uid;const O=Object(l["O"])({id:null,gallery_id:null,gallery_uid:"",image:"",path:"",file_number:0,speed:0,is_ok:!1,watching:!1,is_ref:!1});function j(){n.axios.post(n.COMMON.apiUrl+"/v1/api/work/gallery/list?page="+r.value+"&size="+d.value+"&id="+b.value,{},{headers:{"content-type":"application/json",Authorization:n.$cookies.get("Authorization")}}).then(t=>{200==t.data.code?(s.value=t.data.data,e.value=!1):U.a.show({pos:"top-center",text:t.data.msg,showAction:!1})}).catch(e=>{U.a.show({pos:"top-center",text:e,showAction:!1})})}const u=async()=>{j()};return Object(l["F"])(()=>{j()}),{data:s,error:i,loading:e,gallery_uid:b,showModal:a,page:r,work:O,show:t,size:d,updateModal:c,renewModal:o,reF:u,typeOptions:["movie","tv"].map(e=>({label:e,value:e}))}},methods:{CreateShow(){this.work={id:null,gallery_id:null,gallery_uid:"",image:"",path:"",file_number:0,speed:0,is_ok:!1,watching:!1,is_ref:!1},this.work.gallery_uid=this.gallery_uid,this.showModal=!this.showModal},Editwork(e){this.work=e,this.updateModal=!this.updateModal},showReNew(e){this.work=e,this.renewModal=!this.renewModal},ReNewWork(e){this.Request(this.COMMON.apiUrl+"/v1/api/work/renew?id="+this.work.id,{})},Request(e,t){this.axios.post(e,t,{headers:{"content-type":"application/json",Authorization:this.$cookies.get("Authorization")}}).then(e=>{200==e.data.code?(U.a.show({pos:"top-center",text:e.data.msg,showAction:!1}),this.reF()):U.a.show({pos:"top-center",text:e.data.msg,showAction:!1})}).catch(e=>{U.a.show({pos:"top-center",text:e,showAction:!1})})},Create(){"tv"==this.work.work_type&&(this.work.is_tv=!0),this.show=!0;let e=this.COMMON.apiUrl+"/v1/api/work/create";this.axios.post(e,this.work,{headers:{"content-type":"application/json",Authorization:this.$cookies.get("Authorization")}}).then(e=>{200==e.data.code?(this.show=!1,U.a.show({pos:"top-center",text:e.data.msg,showAction:!1}),this.reF()):U.a.show({pos:"top-center",text:e.data.msg,showAction:!1})}).catch(e=>{U.a.show({pos:"top-center",text:e,showAction:!1})})},Update(){this.Request(this.COMMON.apiUrl+"/v1/api/work/update?id="+this.work.id,this.work)},Delete(){this.Request(this.COMMON.apiUrl+"/v1/api/work/delete?id="+this.work.id,{})},ErrFiles(e){this.$router.push({path:"/gallerys/works/errfiles",query:{id:e.id}})},RefErrFiles(e){this.axios.post(`${this.COMMON.apiUrl}/v1/api/errfile/ref/work/list?id=${e.id}`,{},{headers:{"content-type":"application/json",Authorization:this.$cookies.get("Authorization")}}).then(e=>{U.a.show({pos:"top-center",text:e.data.msg,showAction:!1})}).catch(e=>{U.a.show({pos:"top-center",text:e,showAction:!1})})}}},F=(a("62f9"),a("6b0d")),$=a.n(F);const q=$()(N,[["render",R],["__scopeId","data-v-418cf712"]]);t["default"]=q},"62f9":function(e,t,a){"use strict";a("2f72")}}]);
//# sourceMappingURL=chunk-5d50d0ba.e1c7de1c.js.map